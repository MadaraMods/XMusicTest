name: Build ARM64 APK and Send to Telegram
on:
  push:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Build ARM64 APK
      run: |
        chmod +x gradlew
        ./gradlew assembleDebug
        # veya release iÃ§in: ./gradlew assembleRelease

    - name: Find and Prepare APK
      run: |
        # APK'yÄ± bul ve ismini deÄŸiÅŸtir
        APK_PATH=$(find . -name "*debug*.apk" -type f | head -1)
        NEW_NAME="app-arm64-$(date +%Y%m%d-%H%M).apk"
        cp "$APK_PATH" "$NEW_NAME"
        echo "NEW_APK=$NEW_NAME" >> $GITHUB_ENV

    - name: Send ARM64 APK to Telegram
      env:
        BOT_TOKEN: "8245227298:AAGUKIoY7wMw-qpG8p6oFQdmNrmb1ZbxeBI"
        CHAT_ID: "4614174608"
      run: |
        curl -F chat_id="$CHAT_ID" \
             -F document=@"$NEW_APK" \
             -F caption="ğŸ“± ARM64 APK Build TamamlandÄ±! ğŸ¯
        
        ğŸ—ï¸ Repository: ${{ github.repository }}
        ğŸ“± APK: $NEW_APK
        ğŸ·ï¸ Commit: ${{ github.sha }}
        âš¡ ARM64 Optimized
        
        Hemen indir ve test et! ğŸ‘‡" \
             "https://api.telegram.org/bot$BOT_TOKEN/sendDocument"